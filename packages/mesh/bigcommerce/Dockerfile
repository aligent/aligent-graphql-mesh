# This file is generated by Nx.
#
# Build the docker image with `npx nx docker-build orocommerce-mesh`.
# Tip: Modify "docker-build" options in project.json to change docker build args.
#
# Run the container with `docker run -p 3000:3000 -t orocommerce-mesh`.
FROM docker.io/node:lts-alpine

ENV HOST=0.0.0.0
ENV PORT=3000

WORKDIR /app

RUN addgroup --system orocommerce-mesh && \
          adduser --system -G orocommerce-mesh orocommerce-mesh

COPY dist/packages/mesh orocommerce-mesh
RUN chown -R orocommerce-mesh:orocommerce-mesh .

# You can remove this install step if you build with `--bundle` option.
# The bundled output will include external dependencies.
RUN npm --prefix orocommerce-mesh --omit=dev -f install

CMD [ "node", "orocommerce-mesh" ]


# FROM node:18-buster

# WORKDIR /usr/src/app

# COPY tsconfig.json ./
# COPY package.json ./
# COPY yarn.lock ./
# RUN yarn install
# COPY packages ./packages
# RUN npx tsc

# EXPOSE 4000

# CMD [ "node", "packages/mesh/server.js" ]
